{"ast":null,"code":"import _objectSpread from\"/home/kwenzo/Music/Project/survivalsrs/survival/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from'react';import{ArrowRight,Users,Clock,Bot,Shield,Heart,TrendingUp,Menu,X,ThumbsUp}from'lucide-react';import{Link,useNavigate}from'react-router-dom';import{api}from'../utils/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ChatbotSurvey=()=>{const[messages,setMessages]=useState([]);const[currentInput,setCurrentInput]=useState('');const[currentStep,setCurrentStep]=useState(0);const[surveyData,setSurveyData]=useState({});const[isTyping,setIsTyping]=useState(false);const[currentOptions,setCurrentOptions]=useState([]);const[inputType,setInputType]=useState('text');const messagesEndRef=useRef(null);const[currentView,setCurrentView]=useState('survey');const[isMenuOpen,setIsMenuOpen]=useState(false);const navigate=useNavigate();const handleShareStory=()=>{navigate('/survey');};const goToSurvey=()=>{setIsMenuOpen(false);setCurrentView('survey');};const toggleMenu=()=>setIsMenuOpen(!isMenuOpen);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:\"smooth\"});};useEffect(()=>{scrollToBottom();},[messages,isTyping]);const surveyFlow=[{id:'welcome',botMessage:\"Hello! I'm here to support you on your recovery journey. This survey will help us understand your experience and provide better resources. Everything you share is confidential and anonymous. Are you ready to begin?\",inputType:'options',options:['Yes, let\\'s start','I have questions first'],field:null},{id:'username',botMessage:\"Enter your username\",inputType:'text',field:'userId',validation:val=>val.length<=100,errorMessage:'Please keep username under 100 characters'},{id:'age',botMessage:\"Thank you for participating. Let's start with some basic information. How old are you?\",inputType:'number',field:'demographics.age',validation:val=>val>=18&&val<=100,errorMessage:'Please enter an age between 18 and 100'},{id:'gender',botMessage:\"What is your gender identity?\",inputType:'options',options:['Male','Female','Non-binary','Prefer not to say'],field:'demographics.gender'},{id:'location',botMessage:\"What city or region are you from? (This helps us understand geographical trends)\",inputType:'text',field:'demographics.location',validation:val=>val.length<=100,errorMessage:'Please keep location under 100 characters'},{id:'education',botMessage:\"What's your highest level of education?\",inputType:'options',options:['High School','Some College','College Graduate','Graduate Degree','Other'],field:'demographics.education'},{id:'employment',botMessage:\"What's your current employment status?\",inputType:'options',options:['Employed','Unemployed','Student','Retired','Disabled','Other'],field:'demographics.employment'},{id:'primary_drug',botMessage:\"Now let's talk about your substance use history. What was your primary substance of concern? Remember, this is completely confidential.\",inputType:'options',options:['Alcohol','Cocaine','Heroin','Methamphetamine','Prescription opioids','Cannabis','MDMA/Ecstasy','LSD','Benzodiazepines','Amphetamines','Fentanyl','Other stimulants','Other depressants','Other hallucinogens','Other'],field:'drugHistory.primaryDrug'},{id:'years_of_use',botMessage:\"Approximately how many years did you use this substance?\",inputType:'number',field:'drugHistory.yearsOfUse',validation:val=>val>=0&&val<=50,errorMessage:'Please enter a number between 0 and 50'},{id:'age_started',botMessage:\"At what age did you first start using?\",inputType:'number',field:'drugHistory.ageStarted',validation:val=>val>=10&&val<=65,errorMessage:'Please enter an age between 10 and 65'},{id:'frequency',botMessage:\"How frequently were you using at your peak?\",inputType:'options',options:['Daily','Weekly','Monthly','Occasionally','Binge episodes'],field:'drugHistory.frequencyOfUse'},{id:'quit_attempts',botMessage:\"Recovery is often a journey with multiple attempts. How many times have you tried to quit or get clean?\",inputType:'number',field:'recoveryJourney.quitAttempts',validation:val=>val>=1&&val<=50,errorMessage:'Please enter a number between 1 and 50'},{id:'time_clean',botMessage:\"How many days have you been clean/sober currently? (Enter 0 if you're just starting)\",inputType:'number',field:'recoveryJourney.timeClean',validation:val=>val>=0,errorMessage:'Please enter a number 0 or greater'},{id:'motivations',botMessage:\"What motivated you to seek recovery? You can select multiple options.\",inputType:'multiselect',options:['Family','Children','Health concerns','Legal issues','Financial problems','Career/Employment','Personal growth','Relationships','Spiritual reasons','Near-death experience','Loss of loved one','Rock bottom moment','Pregnancy','Court order','Other'],field:'recoveryJourney.motivations'},{id:'biggest_challenges',botMessage:\"What have been your biggest challenges in recovery? Select all that apply.\",inputType:'multiselect',options:['Cravings','Withdrawal symptoms','Depression/Anxiety','Social pressure','Boredom','Stress management','Relationship problems','Financial stress','Legal issues','Housing instability','Employment issues','Trauma memories','Physical pain','Sleep problems','Other'],field:'recoveryJourney.biggestChallenges'},{id:'success_factors',botMessage:\"What has helped you the most in your recovery journey? Select all that apply.\",inputType:'multiselect',options:['Professional therapy','Support groups (AA/NA)','Family support','Medication-assisted treatment','Inpatient treatment','Outpatient treatment','Sober living','Exercise/fitness','New hobbies','Career focus','Education','Spirituality/religion','Peer support','Medication for mental health','Cognitive behavioral therapy','Group therapy','Individual counseling','Other'],field:'recoveryJourney.successFactors'},{id:'had_therapy',botMessage:\"Have you ever received professional therapy or counseling for mental health issues?\",inputType:'options',options:['Yes','No'],field:'mentalHealth.hadTherapy'},{id:'had_medication',botMessage:\"Have you ever received professional therapy or counseling for mental health issues?\",inputType:'options',options:['Yes','No'],field:'mentalHealth.hadMedication'},{id:'overall_satisfaction',botMessage:\"On a scale of 1-10, how would you rate your overall life satisfaction today?\",inputType:'number',field:'qualityOfLife.overallSatisfaction'},{id:'physical_health',botMessage:\"How would you rate your physical health today? (1-10)\",inputType:'number',field:'qualityOfLife.physicalHealth'},{id:'mental_health_rating',botMessage:\"How would you rate your mental health today? (1-10)\",inputType:'number',field:'qualityOfLife.mentalHealth'},{id:'advice',botMessage:\"What advice would you give to someone just starting their recovery journey? (Optional - feel free to skip)\",inputType:'textarea',field:'advice.adviceForOthers',optional:true},{id:'consent',botMessage:\"Would you consent to having your anonymous responses used to help others in recovery?\",inputType:'options',options:['Yes','No'],field:'consentToShare'},{id:'complete',botMessage:\"Indicate if you are done ?\",inputType:'options',options:['completed','draft'],field:'status'},{id:'submitted',botMessage:\"Thank you so much for sharing your story. Your responses will help create better resources for people on their recovery journey. You're incredibly brave for taking this step. ðŸ’™\\n\\nRemember: Recovery is possible, you matter, and you're not alone.\"}];const setNestedValue=(obj,path,value)=>{const keys=path.split('.');let current=obj;for(let i=0;i<keys.length-1;i++){if(!(keys[i]in current)){current[keys[i]]={};}current=current[keys[i]];}current[keys[keys.length-1]]=value;};const addBotMessage=function(message){let delay=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1000;setIsTyping(true);setTimeout(()=>{setMessages(prev=>[...prev,{type:'bot',content:message,timestamp:new Date()}]);setIsTyping(false);},delay);};const addUserMessage=message=>{setMessages(prev=>[...prev,{type:'user',content:message,timestamp:new Date()}]);};const moveToNextStep=()=>{if(currentStep<surveyFlow.length-1){const nextStep=currentStep+1;setCurrentStep(nextStep);const step=surveyFlow[nextStep];setTimeout(()=>{addBotMessage(step.botMessage,800);setInputType(step.inputType);setCurrentOptions(step.options||[]);},500);}};const handleSubmit=async value=>{const currentStepData=surveyFlow[currentStep];if(currentStepData.inputType==='complete')return;// Validation\nif(currentStepData.validation&&!currentStepData.validation(value)){addBotMessage(currentStepData.errorMessage||'Please check your input and try again.');return;}// Format display value\nlet displayValue=value;if(Array.isArray(value)){displayValue=value.join(', ');}else if(currentStepData.inputType==='options'&&(value==='Yes'||value==='No')){displayValue=value;}addUserMessage(displayValue.toString());// Update survey data\nif(currentStepData.field){const newData=_objectSpread({},surveyData);let processedValue=value;// Convert Yes/No to boolean for therapy/medication fields\nif(currentStepData.field.includes('had')){processedValue=value==='Yes';}setNestedValue(newData,currentStepData.field,processedValue);setSurveyData(newData);}// Reset input\nsetCurrentInput('');// Submit survey if this is the final actionable step\nif(currentStepData.id==='consent'){try{console.log('Submitting surveyData:',surveyData);await api.surveys.addSurvey(surveyData);console.log('Survey submitted successfully');}catch(error){console.error('Survey submission failed:',error);addBotMessage('Oops! Something went wrong while submitting your survey.');}}// Move to next step\nmoveToNextStep();};// Initialize chat\nuseEffect(()=>{if(messages.length===0){addBotMessage(surveyFlow[0].botMessage,500);setInputType(surveyFlow[0].inputType);setCurrentOptions(surveyFlow[0].options||[]);}},[]);const ScaleInput=_ref=>{let{onSubmit}=_ref;const[selectedValue,setSelectedValue]=useState(null);return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500\",children:\"Very Poor\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500\",children:\"Excellent\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"flex space-x-2\",children:[1,2,3,4,5,6,7,8,9,10].map(num=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setSelectedValue(num);onSubmit(num);},className:\"w-8 h-8 rounded-full border-2 text-sm font-medium transition-all \".concat(selectedValue===num?'bg-blue-500 text-white border-blue-500':'border-gray-300 hover:border-blue-400 hover:bg-blue-50'),children:num},num))})]});};const MultiSelectInput=_ref2=>{let{options,onSubmit}=_ref2;const[selected,setSelected]=useState([]);const toggleOption=option=>{setSelected(prev=>prev.includes(option)?prev.filter(item=>item!==option):[...prev,option]);};return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"grid grid-cols-1 gap-2 max-h-48 overflow-y-auto\",children:options.map(option=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>toggleOption(option),className:\"p-3 text-left rounded-lg border transition-all \".concat(selected.includes(option)?'bg-blue-100 border-blue-500 text-blue-700':'bg-white border-gray-200 hover:bg-gray-50'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-4 h-4 rounded border mr-3 \".concat(selected.includes(option)?'bg-blue-500 border-blue-500':'border-gray-300'),children:selected.includes(option)&&/*#__PURE__*/_jsx(\"div\",{className:\"w-full h-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-white rounded-full\"})})}),option]})},option))}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>onSubmit(selected),disabled:selected.length===0,className:\"w-full py-2 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed\",children:[\"Continue (\",selected.length,\" selected)\"]})]});};const renderInput=()=>{const currentStepData=surveyFlow[currentStep];if(inputType==='complete'){return/*#__PURE__*/_jsxs(\"div\",{className:\"text-center p-6 bg-green-50 rounded-lg border border-green-200\",children:[/*#__PURE__*/_jsx(Heart,{className:\"mx-auto mb-4 text-green-500\",size:48}),/*#__PURE__*/_jsx(\"p\",{className:\"text-green-700 font-medium\",children:\"Survey Complete\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-green-600 mt-2\",children:\"Thank you for sharing your story\"})]});}if(inputType==='options'){return/*#__PURE__*/_jsx(\"div\",{className:\"space-y-2\",children:currentOptions.map(option=>/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSubmit(option),className:\"w-full p-3 text-left bg-white border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-all\",children:option},option))});}if(inputType==='scale'){return/*#__PURE__*/_jsx(ScaleInput,{onSubmit:handleSubmit});}if(inputType==='multiselect'){return/*#__PURE__*/_jsx(MultiSelectInput,{options:currentOptions,onSubmit:handleSubmit});}if(inputType==='textarea'){return/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:currentInput,onChange:e=>setCurrentInput(e.target.value),placeholder:\"Share your thoughts... (optional)\",className:\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\",rows:\"4\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSubmit(currentInput),className:\"flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600\",children:\"Submit\"}),currentStepData.optional&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSubmit(''),className:\"py-2 px-4 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400\",children:\"Skip\"})]})]});}// Default text/number input\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:inputType,value:currentInput,onChange:e=>setCurrentInput(e.target.value),placeholder:inputType==='number'?'Enter a number...':'Type your response...',className:\"flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\",onKeyPress:e=>{if(e.key==='Enter'&&currentInput.trim()){handleSubmit(inputType==='number'?Number(currentInput):currentInput);}}}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSubmit(inputType==='number'?Number(currentInput):currentInput),disabled:!currentInput.trim(),className:\"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed\",children:\"Submit\"})]});};return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-2xl mx-auto h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex flex-col\",children:[/*#__PURE__*/_jsx(\"nav\",{className:\"bg-white/90 backdrop-blur-md shadow-lg sticky top-0 z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center py-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl flex items-center justify-center\",children:/*#__PURE__*/_jsx(Shield,{className:\"w-6 h-6 text-white\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl font-bold text-gray-800\",children:\"Survival Serious\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"hidden md:flex items-center space-x-8\",children:[/*#__PURE__*/_jsx(Link,{to:\"/\",className:\"text-gray-700 hover:text-blue-600 transition-colors font-medium\",children:\"Home\"}),/*#__PURE__*/_jsx(Link,{to:\"/dashboard\",className:\"text-gray-700 hover:text-blue-600 transition-colors font-medium\",children:\"Explore\"}),/*#__PURE__*/_jsx(\"a\",{href:\"#contact\",className:\"text-gray-700 hover:text-blue-600 transition-colors font-medium\",children:\"Contact\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleShareStory,className:\"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2 rounded-full hover:shadow-lg transform hover:scale-105 transition-all duration-200 font-medium\",children:\"Share story\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:toggleMenu,className:\"md:hidden p-2 rounded-lg text-gray-700 hover:bg-gray-100\",children:isMenuOpen?/*#__PURE__*/_jsx(X,{className:\"w-6 h-6\"}):/*#__PURE__*/_jsx(Menu,{className:\"w-6 h-6\"})})]}),isMenuOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"md:hidden py-4 border-t border-gray-200\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col space-y-3\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"#home\",className:\"text-gray-700 hover:text-blue-600 transition-colors font-medium px-2 py-1\",children:\"Home\"}),/*#__PURE__*/_jsx(\"a\",{href:\"#about\",className:\"text-gray-700 hover:text-blue-600 transition-colors font-medium px-2 py-1\",children:\"About\"}),/*#__PURE__*/_jsx(\"a\",{href:\"#features\",className:\"text-gray-700 hover:text-blue-600 transition-colors font-medium px-2 py-1\",children:\"Explore\"}),/*#__PURE__*/_jsx(\"a\",{href:\"#contact\",className:\"text-gray-700 hover:text-blue-600 transition-colors font-medium px-2 py-1\",children:\"Contact\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setCurrentView('survey'),className:\"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2 rounded-full font-medium mx-2 mt-2\",children:\"Share story\"})]})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white shadow-sm border-b p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(Heart,{className:\"text-white\",size:20})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"font-semibold text-gray-800\",children:\"Recovery Support Assistant\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600 flex items-center\",children:[/*#__PURE__*/_jsx(Shield,{size:12,className:\"mr-1\"}),\"Confidential & Anonymous\"]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 bg-gray-200 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-500 h-2 rounded-full transition-all duration-500\",style:{width:\"\".concat(currentStep/(surveyFlow.length-1)*100,\"%\")}})}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs text-gray-500 mt-1\",children:[currentStep,\"/\",surveyFlow.length-1,\" questions completed\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-y-auto p-4 space-y-4\",children:[messages.map((message,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"flex \".concat(message.type==='user'?'justify-end':'justify-start'),children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-[80%] p-3 rounded-lg \".concat(message.type==='user'?'bg-blue-500 text-white rounded-br-sm':'bg-white text-gray-800 rounded-bl-sm shadow-sm'),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-2\",children:[message.type==='bot'&&/*#__PURE__*/_jsx(Bot,{size:16,className:\"text-blue-500 mt-1 flex-shrink-0\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"whitespace-pre-wrap\",children:message.content}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-xs mt-1 \".concat(message.type==='user'?'text-blue-100':'text-gray-500'),children:[/*#__PURE__*/_jsx(Clock,{size:10,className:\"inline mr-1\"}),message.timestamp.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})]})]}),message.type==='user'&&/*#__PURE__*/_jsx(Users,{size:16,className:\"text-blue-100 mt-1 flex-shrink-0\"})]})})},index)),isTyping&&/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-start\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-white text-gray-800 rounded-lg rounded-bl-sm shadow-sm p-3 max-w-[80%]\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Bot,{size:16,className:\"text-blue-500\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\"}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\",style:{animationDelay:'0.1s'}}),/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\",style:{animationDelay:'0.2s'}})]})]})})}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),!isTyping&&inputType!=='complete'&&/*#__PURE__*/_jsx(\"div\",{className:\"bg-white border-t p-4\",children:renderInput()})]});};export default ChatbotSurvey;","map":{"version":3,"names":["React","useState","useEffect","useRef","ArrowRight","Users","Clock","Bot","Shield","Heart","TrendingUp","Menu","X","ThumbsUp","Link","useNavigate","api","jsx","_jsx","jsxs","_jsxs","ChatbotSurvey","messages","setMessages","currentInput","setCurrentInput","currentStep","setCurrentStep","surveyData","setSurveyData","isTyping","setIsTyping","currentOptions","setCurrentOptions","inputType","setInputType","messagesEndRef","currentView","setCurrentView","isMenuOpen","setIsMenuOpen","navigate","handleShareStory","goToSurvey","toggleMenu","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","surveyFlow","id","botMessage","options","field","validation","val","length","errorMessage","optional","setNestedValue","obj","path","value","keys","split","i","addBotMessage","message","delay","arguments","undefined","setTimeout","prev","type","content","timestamp","Date","addUserMessage","moveToNextStep","nextStep","step","handleSubmit","currentStepData","displayValue","Array","isArray","join","toString","newData","_objectSpread","processedValue","includes","console","log","surveys","addSurvey","error","ScaleInput","_ref","onSubmit","selectedValue","setSelectedValue","className","children","map","num","onClick","concat","MultiSelectInput","_ref2","selected","setSelected","toggleOption","option","filter","item","disabled","renderInput","size","onChange","e","target","placeholder","rows","onKeyPress","key","trim","Number","to","href","style","width","index","toLocaleTimeString","hour","minute","animationDelay","ref"],"sources":["/home/kwenzo/Music/Project/survivalsrs/survival/client/src/components/Chatbotsurveys.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { ArrowRight, Users, Clock, Bot, Shield, Heart, TrendingUp, Menu, X, ThumbsUp } from 'lucide-react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { api } from '../utils/api'; \r\n\r\nconst ChatbotSurvey = () => {\r\n  const [messages, setMessages] = useState([]);\r\n  const [currentInput, setCurrentInput] = useState('');\r\n  const [currentStep, setCurrentStep] = useState(0);\r\n  const [surveyData, setSurveyData] = useState({});\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const [currentOptions, setCurrentOptions] = useState([]);\r\n  const [inputType, setInputType] = useState('text');\r\n  const messagesEndRef = useRef(null);\r\n\r\n   const [currentView, setCurrentView] = useState('survey');\r\n    const [isMenuOpen, setIsMenuOpen] = useState(false);\r\n  \r\n  const navigate = useNavigate();\r\n  \r\n    const handleShareStory = () => {\r\n      navigate('/survey');\r\n    };\r\n  const goToSurvey = () => {\r\n    setIsMenuOpen(false);\r\n    setCurrentView('survey');\r\n  };\r\n  const toggleMenu = () => setIsMenuOpen(!isMenuOpen);\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n  };\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages, isTyping]);\r\n\r\n  const surveyFlow = [\r\n    {\r\n      id: 'welcome',\r\n      botMessage: \"Hello! I'm here to support you on your recovery journey. This survey will help us understand your experience and provide better resources. Everything you share is confidential and anonymous. Are you ready to begin?\",\r\n      inputType: 'options',\r\n      options: ['Yes, let\\'s start', 'I have questions first'],\r\n      field: null\r\n    },\r\n    {\r\n      id: 'username',\r\n      botMessage: \"Enter your username\",\r\n      inputType: 'text',\r\n      field: 'userId',\r\n      validation: (val) => val.length <= 100,\r\n      errorMessage: 'Please keep username under 100 characters'\r\n    },\r\n    {\r\n      id: 'age',\r\n      botMessage: \"Thank you for participating. Let's start with some basic information. How old are you?\",\r\n      inputType: 'number',\r\n      field: 'demographics.age',\r\n      validation: (val) => val >= 18 && val <= 100,\r\n      errorMessage: 'Please enter an age between 18 and 100'\r\n    },\r\n    {\r\n      id: 'gender',\r\n      botMessage: \"What is your gender identity?\",\r\n      inputType: 'options',\r\n      options: ['Male', 'Female', 'Non-binary', 'Prefer not to say'],\r\n      field: 'demographics.gender'\r\n    },\r\n    {\r\n      id: 'location',\r\n      botMessage: \"What city or region are you from? (This helps us understand geographical trends)\",\r\n      inputType: 'text',\r\n      field: 'demographics.location',\r\n      validation: (val) => val.length <= 100,\r\n      errorMessage: 'Please keep location under 100 characters'\r\n    },\r\n    {\r\n      id: 'education',\r\n      botMessage: \"What's your highest level of education?\",\r\n      inputType: 'options',\r\n      options: ['High School', 'Some College', 'College Graduate', 'Graduate Degree', 'Other'],\r\n      field: 'demographics.education'\r\n    },\r\n    {\r\n      id: 'employment',\r\n      botMessage: \"What's your current employment status?\",\r\n      inputType: 'options',\r\n      options: ['Employed', 'Unemployed', 'Student', 'Retired', 'Disabled', 'Other'],\r\n      field: 'demographics.employment'\r\n    },\r\n    {\r\n      id: 'primary_drug',\r\n      botMessage: \"Now let's talk about your substance use history. What was your primary substance of concern? Remember, this is completely confidential.\",\r\n      inputType: 'options',\r\n      options: ['Alcohol', 'Cocaine', 'Heroin', 'Methamphetamine', 'Prescription opioids', 'Cannabis', 'MDMA/Ecstasy', 'LSD', 'Benzodiazepines', 'Amphetamines', 'Fentanyl', 'Other stimulants', 'Other depressants', 'Other hallucinogens', 'Other'],\r\n      field: 'drugHistory.primaryDrug'\r\n    },\r\n    \r\n    {\r\n      id: 'years_of_use',\r\n      botMessage: \"Approximately how many years did you use this substance?\",\r\n      inputType: 'number',\r\n      field: 'drugHistory.yearsOfUse',\r\n      validation: (val) => val >= 0 && val <= 50,\r\n      errorMessage: 'Please enter a number between 0 and 50'\r\n    },\r\n    {\r\n      id: 'age_started',\r\n      botMessage: \"At what age did you first start using?\",\r\n      inputType: 'number',\r\n      field: 'drugHistory.ageStarted',\r\n      validation: (val) => val >= 10 && val <= 65,\r\n      errorMessage: 'Please enter an age between 10 and 65'\r\n    },\r\n    {\r\n      id: 'frequency',\r\n      botMessage: \"How frequently were you using at your peak?\",\r\n      inputType: 'options',\r\n      options: ['Daily', 'Weekly', 'Monthly', 'Occasionally', 'Binge episodes'],\r\n      field: 'drugHistory.frequencyOfUse'\r\n    },\r\n    {\r\n      id: 'quit_attempts',\r\n      botMessage: \"Recovery is often a journey with multiple attempts. How many times have you tried to quit or get clean?\",\r\n      inputType: 'number',\r\n      field: 'recoveryJourney.quitAttempts',\r\n      validation: (val) => val >= 1 && val <= 50,\r\n      errorMessage: 'Please enter a number between 1 and 50'\r\n    },\r\n    {\r\n      id: 'time_clean',\r\n      botMessage: \"How many days have you been clean/sober currently? (Enter 0 if you're just starting)\",\r\n      inputType: 'number',\r\n      field: 'recoveryJourney.timeClean',\r\n      validation: (val) => val >= 0,\r\n      errorMessage: 'Please enter a number 0 or greater'\r\n    },\r\n    {\r\n      id: 'motivations',\r\n      botMessage: \"What motivated you to seek recovery? You can select multiple options.\",\r\n      inputType: 'multiselect',\r\n      options: ['Family', 'Children', 'Health concerns', 'Legal issues', 'Financial problems', 'Career/Employment', 'Personal growth', 'Relationships', 'Spiritual reasons', 'Near-death experience', 'Loss of loved one', 'Rock bottom moment', 'Pregnancy', 'Court order', 'Other'],\r\n      field: 'recoveryJourney.motivations'\r\n    },\r\n    {\r\n      id: 'biggest_challenges',\r\n      botMessage: \"What have been your biggest challenges in recovery? Select all that apply.\",\r\n      inputType: 'multiselect',\r\n      options: ['Cravings', 'Withdrawal symptoms', 'Depression/Anxiety', 'Social pressure', 'Boredom', 'Stress management', 'Relationship problems', 'Financial stress', 'Legal issues', 'Housing instability', 'Employment issues', 'Trauma memories', 'Physical pain', 'Sleep problems', 'Other'],\r\n      field: 'recoveryJourney.biggestChallenges'\r\n    },\r\n    {\r\n      id: 'success_factors',\r\n      botMessage: \"What has helped you the most in your recovery journey? Select all that apply.\",\r\n      inputType: 'multiselect',\r\n      options: ['Professional therapy', 'Support groups (AA/NA)', 'Family support', 'Medication-assisted treatment', 'Inpatient treatment', 'Outpatient treatment', 'Sober living', 'Exercise/fitness', 'New hobbies', 'Career focus', 'Education', 'Spirituality/religion', 'Peer support', 'Medication for mental health', 'Cognitive behavioral therapy', 'Group therapy', 'Individual counseling', 'Other'],\r\n      field: 'recoveryJourney.successFactors'\r\n    },\r\n    {\r\n      id: 'had_therapy',\r\n      botMessage: \"Have you ever received professional therapy or counseling for mental health issues?\",\r\n      inputType: 'options',\r\n      options: ['Yes', 'No'],\r\n      field: 'mentalHealth.hadTherapy'\r\n    },\r\n\r\n     {\r\n      id: 'had_medication',\r\n      botMessage: \"Have you ever received professional therapy or counseling for mental health issues?\",\r\n      inputType: 'options',\r\n      options: ['Yes', 'No'],\r\n      field: 'mentalHealth.hadMedication'\r\n    },\r\n   \r\n    {\r\n      id: 'overall_satisfaction',\r\n      botMessage: \"On a scale of 1-10, how would you rate your overall life satisfaction today?\",\r\n      inputType: 'number',\r\n      field: 'qualityOfLife.overallSatisfaction'\r\n    },\r\n    {\r\n      id: 'physical_health',\r\n      botMessage: \"How would you rate your physical health today? (1-10)\",\r\n      inputType: 'number',\r\n      field: 'qualityOfLife.physicalHealth'\r\n    },\r\n    {\r\n      id: 'mental_health_rating',\r\n      botMessage: \"How would you rate your mental health today? (1-10)\",\r\n      inputType: 'number',\r\n      field: 'qualityOfLife.mentalHealth'\r\n    },\r\n    {\r\n      id: 'advice',\r\n      botMessage: \"What advice would you give to someone just starting their recovery journey? (Optional - feel free to skip)\",\r\n      inputType: 'textarea',\r\n      field: 'advice.adviceForOthers',\r\n      optional: true\r\n    },\r\n    {\r\n      id: 'consent',\r\n      botMessage: \"Would you consent to having your anonymous responses used to help others in recovery?\",\r\n      inputType: 'options',\r\n      options: ['Yes', 'No'],\r\n      field: 'consentToShare'\r\n    },\r\n    {\r\n      id: 'complete',\r\n      botMessage: \"Indicate if you are done ?\",\r\n      inputType: 'options',\r\n      options: ['completed', 'draft'],\r\n      field: 'status'\r\n    },\r\n     {\r\n      id: 'submitted',\r\n      botMessage: \"Thank you so much for sharing your story. Your responses will help create better resources for people on their recovery journey. You're incredibly brave for taking this step. ðŸ’™\\n\\nRemember: Recovery is possible, you matter, and you're not alone.\",\r\n      \r\n    }\r\n  ];\r\n\r\n  const setNestedValue = (obj, path, value) => {\r\n    const keys = path.split('.');\r\n    let current = obj;\r\n    \r\n    for (let i = 0; i < keys.length - 1; i++) {\r\n      if (!(keys[i] in current)) {\r\n        current[keys[i]] = {};\r\n      }\r\n      current = current[keys[i]];\r\n    }\r\n    \r\n    current[keys[keys.length - 1]] = value;\r\n  };\r\n\r\n  const addBotMessage = (message, delay = 1000) => {\r\n    setIsTyping(true);\r\n    setTimeout(() => {\r\n      setMessages(prev => [...prev, { type: 'bot', content: message, timestamp: new Date() }]);\r\n      setIsTyping(false);\r\n    }, delay);\r\n  };\r\n\r\n  const addUserMessage = (message) => {\r\n    setMessages(prev => [...prev, { type: 'user', content: message, timestamp: new Date() }]);\r\n  };\r\n\r\n  const moveToNextStep = () => {\r\n    if (currentStep < surveyFlow.length - 1) {\r\n      const nextStep = currentStep + 1;\r\n      setCurrentStep(nextStep);\r\n      const step = surveyFlow[nextStep];\r\n      \r\n      setTimeout(() => {\r\n        addBotMessage(step.botMessage, 800);\r\n        setInputType(step.inputType);\r\n        setCurrentOptions(step.options || []);\r\n      }, 500);\r\n    }\r\n  };\r\n\r\n const handleSubmit = async (value) => {\r\n  const currentStepData = surveyFlow[currentStep];\r\n\r\n  if (currentStepData.inputType === 'complete') return;\r\n\r\n  // Validation\r\n  if (currentStepData.validation && !currentStepData.validation(value)) {\r\n    addBotMessage(currentStepData.errorMessage || 'Please check your input and try again.');\r\n    return;\r\n  }\r\n\r\n  // Format display value\r\n  let displayValue = value;\r\n  if (Array.isArray(value)) {\r\n    displayValue = value.join(', ');\r\n  } else if (currentStepData.inputType === 'options' && (value === 'Yes' || value === 'No')) {\r\n    displayValue = value;\r\n  }\r\n\r\n  addUserMessage(displayValue.toString());\r\n\r\n  // Update survey data\r\n  if (currentStepData.field) {\r\n    const newData = { ...surveyData };\r\n    let processedValue = value;\r\n\r\n    // Convert Yes/No to boolean for therapy/medication fields\r\n    if (currentStepData.field.includes('had')) {\r\n      processedValue = value === 'Yes';\r\n    }\r\n\r\n    setNestedValue(newData, currentStepData.field, processedValue);\r\n    setSurveyData(newData);\r\n  }\r\n\r\n  // Reset input\r\n  setCurrentInput('');\r\n\r\n  // Submit survey if this is the final actionable step\r\n  if (currentStepData.id === 'consent') {\r\n    try {\r\n      console.log('Submitting surveyData:', surveyData);\r\n      await api.surveys.addSurvey(surveyData);\r\n      console.log('Survey submitted successfully');\r\n    } catch (error) {\r\n      console.error('Survey submission failed:', error);\r\n      addBotMessage('Oops! Something went wrong while submitting your survey.');\r\n    }\r\n  }\r\n\r\n  // Move to next step\r\n  moveToNextStep();\r\n};\r\n\r\n\r\n  // Initialize chat\r\n  useEffect(() => {\r\n    if (messages.length === 0) {\r\n      addBotMessage(surveyFlow[0].botMessage, 500);\r\n      setInputType(surveyFlow[0].inputType);\r\n      setCurrentOptions(surveyFlow[0].options || []);\r\n    }\r\n  }, []);\r\n\r\n  const ScaleInput = ({ onSubmit }) => {\r\n    const [selectedValue, setSelectedValue] = useState(null);\r\n    \r\n    return (\r\n      <div className=\"space-y-4\">\r\n        <div className=\"flex justify-between items-center\">\r\n          <span className=\"text-xs text-gray-500\">Very Poor</span>\r\n          <span className=\"text-xs text-gray-500\">Excellent</span>\r\n        </div>\r\n        <div className=\"flex space-x-2\">\r\n          {[1,2,3,4,5,6,7,8,9,10].map(num => (\r\n            <button\r\n              key={num}\r\n              onClick={() => {\r\n                setSelectedValue(num);\r\n                onSubmit(num);\r\n              }}\r\n              className={`w-8 h-8 rounded-full border-2 text-sm font-medium transition-all ${\r\n                selectedValue === num \r\n                  ? 'bg-blue-500 text-white border-blue-500' \r\n                  : 'border-gray-300 hover:border-blue-400 hover:bg-blue-50'\r\n              }`}\r\n            >\r\n              {num}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const MultiSelectInput = ({ options, onSubmit }) => {\r\n    const [selected, setSelected] = useState([]);\r\n    \r\n    const toggleOption = (option) => {\r\n      setSelected(prev => \r\n        prev.includes(option) \r\n          ? prev.filter(item => item !== option)\r\n          : [...prev, option]\r\n      );\r\n    };\r\n    \r\n    return (\r\n      <div className=\"space-y-3\">\r\n        <div className=\"grid grid-cols-1 gap-2 max-h-48 overflow-y-auto\">\r\n          {options.map(option => (\r\n            <button\r\n              key={option}\r\n              onClick={() => toggleOption(option)}\r\n              className={`p-3 text-left rounded-lg border transition-all ${\r\n                selected.includes(option)\r\n                  ? 'bg-blue-100 border-blue-500 text-blue-700'\r\n                  : 'bg-white border-gray-200 hover:bg-gray-50'\r\n              }`}\r\n            >\r\n              <div className=\"flex items-center\">\r\n                <div className={`w-4 h-4 rounded border mr-3 ${\r\n                  selected.includes(option) ? 'bg-blue-500 border-blue-500' : 'border-gray-300'\r\n                }`}>\r\n                  {selected.includes(option) && (\r\n                    <div className=\"w-full h-full flex items-center justify-center\">\r\n                      <div className=\"w-2 h-2 bg-white rounded-full\"></div>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                {option}\r\n              </div>\r\n            </button>\r\n          ))}\r\n        </div>\r\n        <button\r\n          onClick={() => onSubmit(selected)}\r\n          disabled={selected.length === 0}\r\n          className=\"w-full py-2 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed\"\r\n        >\r\n          Continue ({selected.length} selected)\r\n        </button>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const renderInput = () => {\r\n    const currentStepData = surveyFlow[currentStep];\r\n    \r\n    if (inputType === 'complete') {\r\n      return (\r\n        <div className=\"text-center p-6 bg-green-50 rounded-lg border border-green-200\">\r\n          <Heart className=\"mx-auto mb-4 text-green-500\" size={48} />\r\n          <p className=\"text-green-700 font-medium\">Survey Complete</p>\r\n          <p className=\"text-sm text-green-600 mt-2\">Thank you for sharing your story</p>\r\n        </div>\r\n      );\r\n    }\r\n    \r\n    if (inputType === 'options') {\r\n      return (\r\n        <div className=\"space-y-2\">\r\n          {currentOptions.map(option => (\r\n            <button\r\n              key={option}\r\n              onClick={() => handleSubmit(option)}\r\n              className=\"w-full p-3 text-left bg-white border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-all\"\r\n            >\r\n              {option}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      );\r\n    }\r\n    \r\n    if (inputType === 'scale') {\r\n      return <ScaleInput onSubmit={handleSubmit} />;\r\n    }\r\n    \r\n    if (inputType === 'multiselect') {\r\n      return <MultiSelectInput options={currentOptions} onSubmit={handleSubmit} />;\r\n    }\r\n    \r\n    if (inputType === 'textarea') {\r\n      return (\r\n        <div className=\"space-y-3\">\r\n          <textarea\r\n            value={currentInput}\r\n            onChange={(e) => setCurrentInput(e.target.value)}\r\n            placeholder=\"Share your thoughts... (optional)\"\r\n            className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none\"\r\n            rows=\"4\"\r\n          />\r\n          <div className=\"flex space-x-2\">\r\n            <button\r\n              onClick={() => handleSubmit(currentInput)}\r\n              className=\"flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600\"\r\n            >\r\n              Submit\r\n            </button>\r\n            {currentStepData.optional && (\r\n              <button\r\n                onClick={() => handleSubmit('')}\r\n                className=\"py-2 px-4 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400\"\r\n              >\r\n                Skip\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n    \r\n    // Default text/number input\r\n    return (\r\n      <div className=\"flex space-x-2\">\r\n        <input\r\n          type={inputType}\r\n          value={currentInput}\r\n          onChange={(e) => setCurrentInput(e.target.value)}\r\n          placeholder={inputType === 'number' ? 'Enter a number...' : 'Type your response...'}\r\n          className=\"flex-1 p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\r\n          onKeyPress={(e) => {\r\n            if (e.key === 'Enter' && currentInput.trim()) {\r\n              handleSubmit(inputType === 'number' ? Number(currentInput) : currentInput);\r\n            }\r\n          }}\r\n        />\r\n        <button\r\n          onClick={() => handleSubmit(inputType === 'number' ? Number(currentInput) : currentInput)}\r\n          disabled={!currentInput.trim()}\r\n          className=\"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed\"\r\n        >\r\n        Submit\r\n        </button>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex flex-col\">\r\n\r\n\r\n\r\n{/* Navigation */}\r\n      <nav className=\"bg-white/90 backdrop-blur-md shadow-lg sticky top-0 z-50\">\r\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n          <div className=\"flex justify-between items-center py-4\">\r\n            <div className=\"flex items-center space-x-2\">\r\n              <div className=\"w-10 h-10 bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl flex items-center justify-center\">\r\n                <Shield className=\"w-6 h-6 text-white\" />\r\n              </div>\r\n              <span className=\"text-2xl font-bold text-gray-800\">Survival Serious</span>\r\n            </div>\r\n            \r\n            {/* Desktop Navigation */}\r\n            <div className=\"hidden md:flex items-center space-x-8\">\r\n              {/* <a href=\"#home\" className=\"text-gray-700 hover:text-blue-600 transition-colors font-medium\">Home</a> */}\r\n\r\n              <Link to=\"/\" className=\"text-gray-700 hover:text-blue-600 transition-colors font-medium\">\r\n  Home\r\n</Link>\r\n        \r\n              \r\n<Link to=\"/dashboard\" className=\"text-gray-700 hover:text-blue-600 transition-colors font-medium\">\r\n  Explore\r\n</Link>\r\n\r\n\r\n\r\n              <a href=\"#contact\" className=\"text-gray-700 hover:text-blue-600 transition-colors font-medium\">Contact</a>\r\n              \r\n<button\r\n      onClick={handleShareStory}\r\n      className=\"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2 rounded-full hover:shadow-lg transform hover:scale-105 transition-all duration-200 font-medium\"\r\n    >\r\n      Share story\r\n    </button>\r\n\r\n\r\n              \r\n            </div>\r\n\r\n            {/* Mobile Menu Button */}\r\n            <button \r\n              onClick={toggleMenu}\r\n              className=\"md:hidden p-2 rounded-lg text-gray-700 hover:bg-gray-100\"\r\n            >\r\n              {isMenuOpen ? <X className=\"w-6 h-6\" /> : <Menu className=\"w-6 h-6\" />}\r\n            </button>\r\n          </div>\r\n\r\n          {/* Mobile Navigation */}\r\n          {isMenuOpen && (\r\n            <div className=\"md:hidden py-4 border-t border-gray-200\">\r\n              <div className=\"flex flex-col space-y-3\">\r\n                <a href=\"#home\" className=\"text-gray-700 hover:text-blue-600 transition-colors font-medium px-2 py-1\">Home</a>\r\n                <a href=\"#about\" className=\"text-gray-700 hover:text-blue-600 transition-colors font-medium px-2 py-1\">About</a>\r\n                <a href=\"#features\" className=\"text-gray-700 hover:text-blue-600 transition-colors font-medium px-2 py-1\">Explore</a>\r\n                <a href=\"#contact\" className=\"text-gray-700 hover:text-blue-600 transition-colors font-medium px-2 py-1\">Contact</a>\r\n                <button  onClick={() => setCurrentView('survey')} className=\"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2 rounded-full font-medium mx-2 mt-2\">\r\n                 Share story\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </nav>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n      {/* Header */}\r\n      <div className=\"bg-white shadow-sm border-b p-4\">\r\n        <div className=\"flex items-center space-x-3\">\r\n          <div className=\"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center\">\r\n            <Heart className=\"text-white\" size={20} />\r\n          </div>\r\n          <div>\r\n            <h1 className=\"font-semibold text-gray-800\">Recovery Support Assistant</h1>\r\n            <p className=\"text-sm text-gray-600 flex items-center\">\r\n              <Shield size={12} className=\"mr-1\" />\r\n              Confidential & Anonymous\r\n            </p>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Progress bar */}\r\n        <div className=\"mt-4 bg-gray-200 rounded-full h-2\">\r\n          <div \r\n            className=\"bg-blue-500 h-2 rounded-full transition-all duration-500\"\r\n            style={{ width: `${(currentStep / (surveyFlow.length - 1)) * 100}%` }}\r\n          />\r\n        </div>\r\n        <p className=\"text-xs text-gray-500 mt-1\">\r\n          {currentStep}/{surveyFlow.length - 1} questions completed\r\n        </p>\r\n      </div>\r\n\r\n      {/* Messages */}\r\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n        {messages.map((message, index) => (\r\n          <div\r\n            key={index}\r\n            className={`flex ${message.type === 'user' ? 'justify-end' : 'justify-start'}`}\r\n          >\r\n            <div\r\n              className={`max-w-[80%] p-3 rounded-lg ${\r\n                message.type === 'user'\r\n                  ? 'bg-blue-500 text-white rounded-br-sm'\r\n                  : 'bg-white text-gray-800 rounded-bl-sm shadow-sm'\r\n              }`}\r\n            >\r\n              <div className=\"flex items-start space-x-2\">\r\n                {message.type === 'bot' && (\r\n                  <Bot size={16} className=\"text-blue-500 mt-1 flex-shrink-0\" />\r\n                )}\r\n                <div className=\"flex-1\">\r\n                  <p className=\"whitespace-pre-wrap\">{message.content}</p>\r\n                  <p className={`text-xs mt-1 ${message.type === 'user' ? 'text-blue-100' : 'text-gray-500'}`}>\r\n                    <Clock size={10} className=\"inline mr-1\" />\r\n                    {message.timestamp.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}\r\n                  </p>\r\n                </div>\r\n                {message.type === 'user' && (\r\n                  <Users size={16} className=\"text-blue-100 mt-1 flex-shrink-0\" />\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n        \r\n        {isTyping && (\r\n          <div className=\"flex justify-start\">\r\n            <div className=\"bg-white text-gray-800 rounded-lg rounded-bl-sm shadow-sm p-3 max-w-[80%]\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                <Bot size={16} className=\"text-blue-500\" />\r\n                <div className=\"flex space-x-1\">\r\n                  <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\"></div>\r\n                  <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{animationDelay: '0.1s'}}></div>\r\n                  <div className=\"w-2 h-2 bg-gray-400 rounded-full animate-bounce\" style={{animationDelay: '0.2s'}}></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n        \r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n\r\n      {/* Input Area */}\r\n      {!isTyping && inputType !== 'complete' && (\r\n        <div className=\"bg-white border-t p-4\">\r\n          {renderInput()}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatbotSurvey;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}